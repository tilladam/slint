// Copyright Â© SixtyFPS GmbH <info@slint.dev>
// SPDX-License-Identifier: GPL-3.0-only OR LicenseRef-Slint-Royalty-free-2.0 OR LicenseRef-Slint-Software-3.0

// cSpell: ignore langtype typeregister

/**
   This file contains the definition off all builtin items
   It is parsed with the normal .slint parser, but the semantic.

   `_` means that that this is a langtype::NativeClass with no parent.
   Exported components are added to the as BuiltinElement.

   comments starting by `//-` have some meanings

   Properties with two way bindings (aliases) are deprecated in favor of the property they point to

   Properties can have default binding which must be an expression without any reference to
   another properties. These binding will be then set by the compiler.
   `output` property mean that the property can be modified by the native Item,
   otherwise it is assumed the native item don't write to that property.
 */

component Empty {
    //-is_internal
}

component Rectangle inherits Empty {
    in property <brush> background;
    in property <brush> color <=> background;
}

component BasicBorderRectangle inherits Rectangle {
    in property <length> border-width;
    in property <length> border-radius;
    in property <brush> border-color;
}

component BorderRectangle inherits BasicBorderRectangle {
    in property <length> border-top-left-radius;
    in property <length> border-top-right-radius;
    in property <length> border-bottom-left-radius;
    in property <length> border-bottom-right-radius;
    //-default_size_binding:expands_to_parent_geometry
}

export { BorderRectangle as Rectangle }

component ImageItem inherits Empty {
    in property <length> width;
    in property <length> height;
    in property <image> source;
    in property <ImageFit> image-fit;
    in property <ImageRendering> image-rendering;
    in property <brush> colorize;

    in property <angle> rotation-angle <=> transform-rotation;
}

export component ClippedImage inherits ImageItem {
    in property <int> source-clip-x;
    in property <int> source-clip-y;
    in property <int> source-clip-width;
    in property <int> source-clip-height;
    //-default_size_binding:implicit_size

    in property <ImageHorizontalAlignment> horizontal-alignment;
    in property <ImageVerticalAlignment> vertical-alignment;
    in property <ImageTiling> horizontal-tiling;
    in property <ImageTiling> vertical-tiling;
    // TODO: sets both horizontal-tiling and vertical-tiling at the same time.
    // in property <ImageTiling> tiling;

}

export { ClippedImage as Image }

export component ComponentContainer inherits Empty {
    in property <component-factory> component-factory;
    out property <bool> has-component;

    in-out property <length> width;
    in-out property <length> height;
    //-accepts_focus
}

export component Transform inherits Empty {
    in property <angle> transform-rotation;
    in property <percent> transform-scale-x;
    in property <percent> transform-scale-y;
    in property <Point> transform-origin;
    //-default_size_binding:expands_to_parent_geometry
    //-is_internal
}

component SimpleText inherits Empty {
    in property <length> width;
    in property <length> height;
    in property <string> text;
    in property <length> font-size;
    in property <int> font-weight;
    in property <brush> color;  // StyleMetrics.default-text-color  set in apply_default_properties_from_style
    in property <TextHorizontalAlignment> horizontal-alignment;
    in property <TextVerticalAlignment> vertical-alignment;
    //-default_size_binding:implicit_size

    in property <angle> rotation-angle <=> transform-rotation;
}

component ComplexText inherits SimpleText {
    in property <string> font-family;
    in property <bool> font-italic;
    in property <TextOverflow> overflow;
    in property <TextWrap> wrap;
    in property <length> letter-spacing;
    in property <brush> stroke;
    in property <length> stroke-width;
    in property <TextStrokeStyle> stroke-style;
    //-default_size_binding:implicit_size
}

export { ComplexText as Text }

component StyledTextItem inherits Empty {
    in property <length> width;
    in property <length> height;
    in property <styled-text> text;
    in property <length> font-size;
    in property <int> font-weight;
    in property <brush> color;
    in property <TextHorizontalAlignment> horizontal-alignment;
    in property <TextVerticalAlignment> vertical-alignment;
    callback link-clicked(link: string);
    in property <color> link-color: #00f;

    in property <string> font-family;
    in property <bool> font-italic;
    in property <TextOverflow> overflow;
    in property <TextWrap> wrap;
    in property <length> letter-spacing;
    in property <brush> stroke;
    in property <length> stroke-width;
    in property <TextStrokeStyle> stroke-style;
    //-default_size_binding:implicit_size
}

export { StyledTextItem as StyledText }

export component TouchArea {
    in property <bool> enabled: true;
    out property <bool> pressed;
    out property <bool> has_hover;
    out property <length> mouse_x;
    out property <length> mouse_y;
    out property <length> pressed_x;
    out property <length> pressed_y;
    in property <MouseCursor> mouse-cursor;
    callback clicked;
    callback double-clicked;
    callback moved;
    callback pointer-event(event: PointerEvent);
    callback scroll-event(event: PointerScrollEvent) -> EventResult;
    //-default_size_binding:expands_to_parent_geometry
}

export component FocusScope {
    in property <bool> enabled: true;
    in property <bool> focus-on-click: true;
    in property <bool> focus-on-tab-navigation: true;
    out property <bool> has-focus;
    callback capture_key_pressed(event: KeyEvent) -> EventResult;
    callback capture_key_released(event: KeyEvent) -> EventResult;
    callback key_pressed(event: KeyEvent) -> EventResult;
    callback key_released(event: KeyEvent) -> EventResult;
    callback focus_changed_event(reason: FocusReason);
    callback focus_gained(reason: FocusReason);
    callback focus_lost(reason: FocusReason);
    //-default_size_binding:expands_to_parent_geometry
    //-accepts_focus
}

export component Flickable inherits Empty {
    in property <length> viewport-height;
    in property <length> viewport-width;
    in-out property <length> viewport-x;
    in-out property <length> viewport-y;
    in property <bool> interactive: true;
    callback flicked();
    //-default_size_binding:expands_to_parent_geometry
}

export component SwipeGestureHandler {
    in property <bool> enabled: true;
    in property <bool> handle-swipe-left;
    in property <bool> handle-swipe-right;
    in property <bool> handle-swipe-up;
    in property <bool> handle-swipe-down;

    // For the future
    //in property <length> swipe-distance-threshold: 8px;
    //in property <duration> swipe-duration-threshold: 500ms;
    // in property <bool> delays-propgataion;
    //in property <duration> propgataion-delay: 100ms;
    // in property <int> required-touch-points: 1;
    //callback swipe-recognized();

    out property <Point> pressed-position;
    out property <Point> current-position;
    out property <bool> swiping;

    callback moved();
    // the cursor is released and so the swipe is finished
    callback swiped();
    // the cursor is released and so the swipe is finished
    callback cancelled();

    // clears state, invokes swipe-cancelled()
    function cancel() {
    }

    //-default_size_binding:expands_to_parent_geometry
}

export component DragArea {
    in property <bool> enabled: true;
    //out property <bool> dragging;
    in property <string> mime-type;
    in property <string> data;
    //-default_size_binding:expands_to_parent_geometry

}

export component DropArea {
    in property <bool> enabled: true;
    callback can-drop(event: DropEvent) -> bool;
    callback dropped(event: DropEvent);
    out property <bool> contains-drag;
    //-default_size_binding:expands_to_parent_geometry
}

component MenuItem {
    in property <string> title;
    callback activated();
    in property <bool> enabled: true;
    in property <bool> checkable: false;
    in-out property <bool> checked: false;
    in property <image> icon;
    //-disallow_global_types_as_child_elements
    //-is_non_item_type
}

component MenuSeparator {
    //-disallow_global_types_as_child_elements
    //-is_non_item_type
}

component Menu {
    in property <string> title;
    in property <bool> enabled: true;
    in property <image> icon;
    MenuItem { }

    MenuSeparator { }

    Menu { }
    //-disallow_global_types_as_child_elements
    //-is_non_item_type
}

// Lowered in lower_menus pass. See that pass documentation for more info
component MenuBar {
    //-is_non_item_type
    //-disallow_global_types_as_child_elements
    Menu { }
}

// The NativeItem, exported as ContextMenuInternal for the style
component ContextMenu inherits Empty {
    callback activated(entry: MenuEntry);
    callback sub-menu(entry: MenuEntry) -> [MenuEntry];
    callback show(position: Point);
    function close() {
    }
    function is-open() -> bool {
    }
    in property <bool> enabled: true;
}

// Lowered in lower_menus pass.
export component ContextMenuInternal inherits ContextMenu {
    in property <[MenuEntry]> entries;
    //-default_size_binding:expands_to_parent_geometry
    //-is_internal
}

// The public ContextMenu which is lowered in the lower_menus pass. See that pass documentation for more info
// Note that this element cannot be named `ContextMenu` because that's the same name as a native item,
// and the load_builtins code doesn't allow that. So use a placeholder name and re-export under `ContextMenu`
export component ContextMenuArea inherits Empty {
    // This is actually function as part of out interface, but a callback as much is the runtime concerned
    callback show(position: Point);
    function close() {
    }
    //-default_size_binding:expands_to_parent_geometry
    Menu { }

    in property <bool> enabled: true;
}

component WindowItem {
    in-out property <length> width;
    in-out property <length> height;
    out property <length> safe-area-inset-top;
    out property <length> safe-area-inset-bottom;
    out property <length> safe-area-inset-left;
    out property <length> safe-area-inset-right;
    out property <length> virtual-keyboard-x;
    out property <length> virtual-keyboard-y;
    out property <length> virtual-keyboard-width;
    out property <length> virtual-keyboard-height;
    in property <brush> background; // StyleMetrics.background  set in apply_default_properties_from_style
    in property <brush> color <=> background;
    in property <string> title: "Slint Window";
    in property <bool> no-frame;
    in property <length> resize-border-width;
    in property <bool> always-on-top;
    in-out property <bool> full-screen;
    in property <string> default-font-family;
    in property <length> default-font-size;
    in property <int> default-font-weight;
    in property <image> icon;
}

export component Window inherits WindowItem {
    MenuBar { }
}

export component BoxShadow inherits Empty {
    in property <length> border_radius;
    in property <length> offset_x;
    in property <length> offset_y;
    in property <color> color;
    in property <length> blur;
    //-default_size_binding:expands_to_parent_geometry
    //-is_internal
}

export component TextInput {
    in-out property <string> text;
    in property <string> font-family;
    in property <length> font-size;
    in property <bool> font-italic;
    in property <int> font-weight;
    in property <brush> color; // StyleMetrics.default-text-color  set in apply_default_properties_from_style
    in property <color> selection-foreground-color; // StyleMetrics.selection-foreground set in apply_default_properties_from_style
    in property <color> selection-background-color; // StyleMetrics.selection-background set in apply_default_properties_from_style
    in property <TextHorizontalAlignment> horizontal-alignment;
    in property <TextVerticalAlignment> vertical-alignment;
    in property <TextWrap> wrap;
    in property <length> letter-spacing;
    in property <length> width;
    in property <length> height;
    in property <length> page-height;
    in property <length> text-cursor-width; // StyleMetrics.text-cursor-width  set in apply_default_properties_from_style
    in property <InputType> input-type;
    // Internal, undocumented property, only exposed for tests.
    out property <int> cursor-position_byte-offset;
    // Internal, undocumented property, only exposed for tests.
    out property <int> anchor-position-byte-offset;
    out property <bool> has-focus;
    callback accepted;
    callback edited;
    callback cursor_position_changed(position: Point);
    callback key_pressed(event: KeyEvent) -> EventResult;
    callback key_released(event: KeyEvent) -> EventResult;
    in property <bool> enabled: true;
    in property <bool> single-line: true;
    in property <bool> read-only: false;
    // Internal, undocumented property, only exposed for IME.
    out property <string> preedit-text;
    //-default_size_binding:expands_to_parent_geometry
    //-accepts_focus
    function set-selection-offsets(start: int, end: int) {
    }
    function select-all() {
    }
    function clear-selection() {
    }
    function cut() {
    }
    function copy() {
    }
    function paste() {
    }
}

export component Clip {
    in property <length> border-top-left-radius;
    in property <length> border-top-right-radius;
    in property <length> border-bottom-left-radius;
    in property <length> border-bottom-right-radius;
    in property <length> border-width;
    in property <bool> clip;
    //-default_size_binding:expands_to_parent_geometry
    //-is_internal
}

export component Opacity {
    in property <float> opacity: 1;
    //-default_size_binding:expands_to_parent_geometry
    //-is_internal
}

export component Layer inherits Empty {
    in property <bool> cache-rendering-hint;
    //-default_size_binding:expands_to_parent_geometry
    //-is_internal
}

component Row {
    //-is_non_item_type
}

// Note: layouts are not NativeClass, but this is lowered in lower_layout
export component GridLayout {
    in property <length> spacing-horizontal;
    in property <length> spacing-vertical;
    in property <length> spacing;

    // Additional accepted child
    Row { }
}

export component VerticalLayout {
    in property <length> spacing;
    in property <LayoutAlignment> alignment;
}

export component HorizontalLayout {
    in property <length> spacing;
    in property <LayoutAlignment> alignment;
}

component MoveTo {
    in property <float> x;
    in property <float> y;

    //-builtin_struct:PathMoveTo
    //-is_non_item_type
}

component LineTo {
    in property <float> x;
    in property <float> y;

    //-builtin_struct:PathLineTo
    //-is_non_item_type
}

component ArcTo {
    in property <float> x;
    in property <float> y;
    in property <float> radius-x;
    in property <float> radius-y;
    in property <float> x-rotation;
    in property <bool> large_arc;
    in property <bool> sweep;

    //-builtin_struct:PathArcTo
    //-is_non_item_type
}

component CubicTo {
    in property <float> control-1-x;
    in property <float> control-1-y;
    in property <float> control-2-x;
    in property <float> control-2-y;
    in property <float> x;
    in property <float> y;

    //-builtin_struct:PathCubicTo
    //-is_non_item_type
}

component QuadraticTo {
    in property <float> control-x;
    in property <float> control-y;
    in property <float> x;
    in property <float> y;

    //-builtin_struct:PathQuadraticTo
    //-is_non_item_type
}

component Close {
    //-builtin_struct:PathClose
    //-is_non_item_type
}

export component Path {
    in property <brush> fill;
    in property <FillRule> fill-rule;
    in property <brush> stroke;
    in property <length> stroke-width;
    in property <LineCap> stroke-line-cap;
    in property <LineJoin> stroke-line-join;
    in property <string> commands;  // 'fake' hardcoded in typeregister.rs
    in property <float> viewbox-x;
    in property <float> viewbox-y;
    in property <float> viewbox-width;
    in property <float> viewbox-height;
    in property <bool> clip;
    in property <bool> anti-alias: true;

    //-disallow_global_types_as_child_elements
    MoveTo { }

    LineTo { }

    ArcTo { }

    CubicTo { }

    QuadraticTo { }

    Close { }

    //-default_size_binding:expands_to_parent_geometry
}

component Tab {
    in property <string> title;
}

// Note: not a native class, handled in the lower_tabs pass
export component TabWidget {
    in-out property <int> current-index;
    in property <Orientation> orientation;

    //-disallow_global_types_as_child_elements
    Tab { }
    //-default_size_binding:expands_to_parent_geometry
    //-is_internal
}

// Note: not a native class, handled in the lower_popups pass
export component PopupWindow {
    //property <length> x;
    //property <length> y;
    in property <length> width;
    in property <length> height;
    /*property <length> anchor_x;
    in property <length> anchor_y;
    in property <length> anchor_height;
    in property <length> anchor_width;*/
    in property <bool> close-on-click;
    in property <PopupClosePolicy> close-policy; // constexpr hardcoded in typeregister.rs
    //show() is hardcoded in typeregister.rs
}

// Also not a real Item. Actually not an element at all
export component Timer {
    in property <duration> interval;
    callback triggered;
    in property <bool> running: true;
    function start() {
    }
    function stop() {
    }
    function restart() {
    }
    //-is_non_item_type
    //-disallow_global_types_as_child_elements
}

export component Dialog inherits WindowItem { }

component PropertyAnimation {
    in property <duration> delay;
    in property <duration> duration;
    in property <AnimationDirection> direction;
    in property <easing> easing;
    in property <float> iteration-count: 1.0;
    //-is_non_item_type
}

export global TextInputInterface {
    in property <bool> text-input-focused;
}

export global Platform {
    out property <OperatingSystemType> os;
    out property <string> style-name;
}

export component NativeButton {
    in property <string> text;
    in property <image> icon;
    out property <bool> pressed;
    in property <bool> checkable;
    in-out property <bool> checked;
    out property <bool> has-focus;
    in property <bool> primary;
    in property <bool> colorize-icon;
    in property <length> icon-size;
    callback clicked;
    in property <bool> enabled: true;
    in property <StandardButtonKind> standard-button-kind;
    in property <bool> is-standard-button;
    //-is_internal
    //-accepts_focus
}

export component NativeCheckBox {
    in property <bool> enabled: true;
    in property <string> text;
    in-out property <bool> checked;
    out property <bool> has-focus;
    callback toggled;
    //-is_internal
    //-accepts_focus
}

export component NativeSpinBox {
    in property <bool> enabled: true;
    out property <bool> has-focus;
    in-out property <int> value;
    in property <int> minimum;
    in property <int> maximum: 100;
    in property <int> step-size: 1;
    in property <TextHorizontalAlignment> horizontal-alignment;
    in property <bool> read-only;
    callback edited(value: int);
    //-is_internal
    //-accepts_focus
}

export component NativeSlider {
    in property <bool> enabled: true;
    out property <bool> has-focus;
    in-out property <float> value;
    in property <float> minimum;
    in property <float> maximum: 100;
    in property <float> step: 1;
    in property <Orientation> orientation: Orientation.horizontal;
    callback changed(value: float);
    callback released(value: float);
    //-is_internal
    //-accepts_focus
}

export component NativeProgressIndicator {
    in property <bool> indeterminate;
    in property <float> progress;
    //-is_internal
}

export component NativeGroupBox {
    in property <bool> enabled: true;
    in property <string> title;
    out property <length> native-padding-left;
    out property <length> native-padding-right;
    out property <length> native-padding-top;
    out property <length> native-padding-bottom;
    //-default_size_binding:expands_to_parent_geometry
    //-is_internal
}

export component NativeLineEdit {
    out property <length> native-padding-left;
    out property <length> native-padding-right;
    out property <length> native-padding-top;
    out property <length> native-padding-bottom;
    out property <image> clear-icon;
    in property <bool> has-focus;
    in property <bool> enabled: true;
    //-is_internal
}

export component NativeScrollView {
    in property <length> horizontal-max;
    in property <length> horizontal-page-size;
    in property <length> horizontal-value;
    in property <length> vertical-max;
    in property <length> vertical-page-size;
    in-out property <length> vertical-value;
    out property <length> native-padding-left;
    out property <length> native-padding-right;
    out property <length> native-padding-top;
    out property <length> native-padding-bottom;
    in property <bool> has_focus;
    in property <ScrollBarPolicy> vertical-scrollbar-policy;
    in property <ScrollBarPolicy> horizontal-scrollbar-policy;
    in property <bool> enabled: true;
    callback scrolled;
    //-default_size_binding:expands_to_parent_geometry
    //-is_internal
}

export component NativeStandardListViewItem {
    in property <int> index;
    in property <StandardListViewItem> item;
    in-out property <bool> is_selected;
    in property <bool> has_hover;
    in property <bool> has_focus;
    in property <bool> pressed;
    in property <bool> combobox;
    in property <length> pressed-x;
    in property <length> pressed-y;
    //-is_internal
}

export component NativeTableHeaderSection {
    in property <int> index;
    in property <TableColumn> item;
    in property <bool> has_hover;
    //-is_internal
}

export component NativeComboBox {
    in-out property <string> current_value;
    in property <bool> enabled: true;
    in property <bool> has-focus;
    //-is_internal
}

export component NativeComboBoxPopup {
    //-is_internal
}

export component NativeTabWidget {
    in property <length> width;
    in property <length> height;

    out property <length> content-x;
    out property <length> content-y;
    out property <length> content-height;
    out property <length> content-width;
    out property <length> tabbar-x;
    out property <length> tabbar-y;
    out property <length> tabbar-height;
    out property <length> tabbar-width;
    in property <length> tabbar-preferred-height;
    in property <length> tabbar-preferred-width;
    in property <length> content-min-height;
    in property <length> content-min-width;

    in property <int> current-index;
    in property <int> current-focused;
    in property <Orientation> orientation: Orientation.horizontal;
    //-default_size_binding:expands_to_parent_geometry
    //-is_internal
}

// ============================================================================
// Node Editor Components
// ============================================================================

/// Background layer for node editors.
/// Provides viewport properties (pan, zoom) and generates grid path commands.
/// Use a Path component bound to grid-commands to render the grid.
export component NodeEditorBackground inherits Empty {
    /// Spacing between grid lines
    in property <length> grid-spacing: 24px;
    /// Color of the grid lines
    in property <color> grid-color: #404040;
    /// Background color of the canvas
    in property <brush> background-color: #1a1a1a;
    /// Current pan offset X
    in-out property <length> pan-x;
    /// Current pan offset Y
    in-out property <length> pan-y;
    /// Current zoom level
    in property <float> zoom: 1.0;

    /// Generated SVG path commands for grid lines (output, updated by native code)
    out property <string> grid-commands;

    // === Link reporting (input from application) ===
    in property <int> reporting-link-id;
    in property <int> reporting-link-start-pin-id;
    in property <int> reporting-link-end-pin-id;
    in property <color> reporting-link-color;
    callback link-reported();
    in-out property <string> pending-links-batch;
    in-out property <string> pending-deleted-link-ids;

    // === Pin and node position reporting (needed for link calculation) ===
    in-out property <string> pending-pins-batch;
    in-out property <string> pending-node-rects-batch;

    // === Link bezier paths (output - generated by core) ===
    in-out property <string> link-bezier-paths;
    callback link-positions-changed();

    // === Link query mechanism (for Overlay to query link hit-testing) ===
    /// Query position X (set by composite when Overlay queries)
    in-out property <length> query-link-at-x;
    /// Query position Y (set by composite when Overlay queries)
    in-out property <length> query-link-at-y;
    /// Link hover distance for hit-testing
    in property <length> link-hover-distance: 5px;
    /// Result of link query (set by core, read by composite)
    out property <int> link-at-result: -1;
    /// Callback to trigger link query (call after setting query properties)
    callback handle-link-query();

    /// Callback to process pending reports (called by changed handlers)
    callback process-pending-reports-callback();

    // Process pending reports immediately when batches change
    // This ensures links appear as soon as they're created
    changed pending-links-batch => { process-pending-reports-callback(); }
    changed pending-pins-batch => { process-pending-reports-callback(); }
    changed pending-node-rects-batch => { process-pending-reports-callback(); }

    //-default_size_binding:expands_to_parent_geometry
}

/// Overlay layer for node editors. Handles input and exposes state for Slint-rendered overlays.
export component NodeEditorOverlay inherits Empty {
    /// Current pan offset X (should be bound to NodeEditorBackground.pan-x)
    in-out property <length> pan-x;
    /// Current pan offset Y (should be bound to NodeEditorBackground.pan-y)
    in-out property <length> pan-y;
    /// Current zoom level
    in-out property <float> zoom: 1.0;
    /// Minimum zoom level
    in property <float> min-zoom: 0.1;
    /// Maximum zoom level
    in property <float> max-zoom: 3.0;

    // === Selection box state (for Slint rendering) ===
    /// Whether a box selection is currently active
    out property <bool> is-selecting: false;
    /// Selection box X coordinate (min of start and current)
    out property <length> selection-x;
    /// Selection box Y coordinate (min of start and current)
    out property <length> selection-y;
    /// Selection box width
    out property <length> selection-width;
    /// Selection box height
    out property <length> selection-height;

    // === Node drag state (for applying offset to link positions) ===
    /// Whether nodes are currently being dragged (set by Slint during drag)
    in property <bool> is-dragging: false;
    /// X offset of dragged nodes in screen coordinates (applied to selected nodes' link endpoints)
    in property <length> drag-offset-x;
    /// Y offset of dragged nodes in screen coordinates (applied to selected nodes' link endpoints)
    in property <length> drag-offset-y;

    // === Context menu state ===
    /// X coordinate where context menu was requested
    out property <length> context-menu-x;
    /// Y coordinate where context menu was requested
    out property <length> context-menu-y;

    // === Active link creation state (for Slint rendering) ===
    /// Whether a link is currently being created
    out property <bool> is-creating-link: false;
    /// X coordinate of link start (where drag started)
    out property <length> link-start-x;
    /// Y coordinate of link start
    out property <length> link-start-y;
    /// Current X coordinate of link end (mouse position, can be updated externally during drag)
    in-out property <length> link-end-x;
    /// Current Y coordinate of link end (mouse position, can be updated externally during drag)
    in-out property <length> link-end-y;
    /// ID of the pin from which link creation started
    out property <int> link-start-pin-id: -1;
    /// Core-generated SVG bezier path command for link preview
    /// Format: "M x0 y0 C x1 y1 x2 y2 x3 y3"
    out property <string> link-preview-path-commands;

    // === Link creation trigger (set properties then call callback) ===
    /// Pin ID to start link from (set before calling start-link)
    in property <int> pending-link-pin-id;
    /// X position to start link from (set before calling start-link)
    in property <length> pending-link-x;
    /// Y position to start link from (set before calling start-link)
    in property <length> pending-link-y;
    /// Callback to start link creation - set pending-link-* properties first
    callback start-link();

    // === Link completion trigger (for when pin TouchArea has mouse capture) ===
    /// Set to true to complete link creation (set target-pin-id first)
    in property <bool> complete-link-creation: false;
    /// Target pin ID computed by Slint (0 if dropped on empty space)
    in property <int> target-pin-id;

    // === Pin position reporting (for hit-testing during link creation) ===
    /// Pin ID being reported (set before calling pin-position-changed)
    in property <int> reporting-pin-id;
    /// X position of pin being reported (in screen coordinates)
    in property <length> reporting-pin-x;
    /// Y position of pin being reported (in screen coordinates)
    in property <length> reporting-pin-y;
    /// Hit radius for pin detection (0 = auto-compute based on pin size and zoom)
    in property <length> pin-hit-radius;
    /// Callback when a pin reports its position - set reporting-pin-* properties first
    callback pin-position-changed();
    /// Batch of pending pin positions to register (format: "id,x,y;...")
    /// Used when multiple pins report positions at once (e.g., on viewport change)
    in-out property <string> pending-pins-batch;

    // === Link request result (set when link-requested is fired) ===
    /// Start pin ID of the requested link (read from callback)
    out property <int> requested-link-start-pin;
    /// End pin ID of the requested link (read from callback)
    out property <int> requested-link-end-pin;

    // === Node rectangle reporting (for hit-testing and box selection) ===
    /// Node ID being reported (set before triggering node-rect-changed)
    in property <int> reporting-node-id;
    /// X position of node being reported (in screen coordinates)
    in property <length> reporting-node-x;
    /// Y position of node being reported (in screen coordinates)
    in property <length> reporting-node-y;
    /// Width of node being reported
    in property <length> reporting-node-width;
    /// Height of node being reported
    in property <length> reporting-node-height;
    /// Callback when a node reports its rectangle - set reporting-node-* properties first
    callback node-rect-changed();
    /// Batch of pending node rects to register (format: "id,x,y,w,h;...")
    /// Used when multiple nodes report rects at once (e.g., during init)
    in-out property <string> pending-node-rects-batch;

    // NOTE: Link reporting properties moved to NodeEditorBackground
    // - reporting-link-id, reporting-link-start-pin-id, reporting-link-end-pin-id, reporting-link-color
    // - link-reported callback
    // - pending-links-batch, pending-deleted-link-ids
    // - link-bezier-paths, link-positions-changed callback

    // === Box selection result (output when selection-changed fires) ===
    /// Comma-separated list of node IDs that intersect with the selection box
    out property <string> selected-node-ids-str;

    // === Node selection management ===
    /// Node ID being clicked (set before calling node-clicked)
    in property <int> clicked-node-id;
    /// Whether shift was held during node click
    in property <bool> clicked-shift-held;
    /// Callback when a node is clicked - set clicked-node-id and clicked-shift-held first
    callback node-clicked();

    /// Comma-separated list of currently selected node IDs (output)
    out property <string> current-selected-ids;

    // === Link hover state ===
    /// ID of the link currently being hovered, or -1 if none
    out property <int> hovered-link-id: -1;
    /// Hit distance threshold for link hover detection (in screen pixels)
    in property <length> link-hover-distance: 8px;

    // === Link selection state ===
    /// Comma-separated list of currently selected link IDs (output)
    out property <string> current-selected-link-ids;

    /// Callback when user requests link creation (read requested-link-start-pin and requested-link-end-pin)
    /// Application should validate compatibility and create link if valid
    callback link-requested();
    /// Callback when hovered link changes (check hovered-link-id for current value)
    callback link-hovered();
    /// Callback when link selection changes (check current-selected-link-ids for selected links)
    callback link-selection-changed();

    // === Query properties (for querying Background layer) ===
    /// Query position X (set this along with query-link-at-y to trigger query)
    in-out property <length> query-link-at-x;
    /// Query position Y (set this along with query-link-at-x to trigger query)
    in-out property <length> query-link-at-y;
    /// Result of link query (link ID or -1 if none found)
    in property <int> link-at-result: -1;

    // === Debug properties ===
    /// Number of registered pins (for debugging)
    out property <int> debug-pin-count;

    /// Callback when link creation is cancelled
    callback link-cancelled();
    /// Callback for context menu
    callback context-menu-requested();
    /// Callback when box selection completes (read selected-node-ids-str for intersecting nodes)
    callback selection-changed();
    /// Callback when viewport changes (pan or zoom)
    callback viewport-changed();
    /// Callback when delete key is pressed (Delete or Backspace)
    callback delete-selected();
    /// Callback when add node shortcut is pressed (Ctrl+N)
    callback add-node-requested();

    //-accepts_focus
    //-default_size_binding:expands_to_parent_geometry
}

// Note: A standard NodeEditorLink component is not included in builtins because
// components here can only inherit from Empty, not from Path. Users should create
// their own Link component using Path directly. Example:
//
//   component Link inherits Path {
//       in property <string> path-commands;
//       in property <color> link-color: #888888;
//       in property <length> line-width: 2px;
//       width: 100%; height: 100%;
//       stroke: link-color; stroke-width: line-width; fill: transparent;
//       viewbox-x: 0; viewbox-y: 0;
//       viewbox-width: max(self.width / 1px, 1);
//       viewbox-height: max(self.height / 1px, 1);
//       commands: path-commands;
//   }

export component NativeTab {
    in property <string> title;
    in property <image> icon;
    in property <bool> enabled: true;
    in-out property <int> current; // supposed to be a binding to the tab
    in property <int> tab-index;
    in property <int> current-focused;
    in property <int> num-tabs;
    //-is_internal
}

export global NativeStyleMetrics {
    out property <length> layout-spacing;
    out property <length> layout-padding;
    out property <length> text-cursor-width;
    out property <color> window-background;
    out property <color> default-text-color;
    out property <color> textedit-background;
    out property <color> textedit-text-color;
    out property <color> textedit-background-disabled;
    out property <color> textedit-text-color-disabled;

    out property <bool> dark-color-scheme;

    // specific to the Native one
    out property <color> placeholder-color;
    out property <color> placeholder-color-disabled;

    // Tab Bar metrics:
    out property <LayoutAlignment> tab-bar-alignment;

    //-is_non_item_type
    //-is_internal
}

export global NativePalette {
    out property <brush> background;
    out property <brush> foreground;
    out property <brush> alternate-background;
    out property <brush> alternate-foreground;
    out property <brush> control-background;
    out property <brush> control-foreground;
    out property <brush> accent-background;
    out property <brush> accent-foreground;
    out property <brush> selection-background;
    out property <brush> selection-foreground;
    out property <brush> border;
    in-out property <ColorScheme> color-scheme;

    //-is_non_item_type
    //-is_internal
}
